getwd()
library(data.table)
census1 = fread('ss16pusa.csv')
census1 = census1[,c("ST","ADJINC","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","PINCP","AGEP","CITWP","COW","SERIALNO")]
census2 = fread('ss16pusb.csv')
census2 = census2[,c("ST","ADJINC","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","PINCP","AGEP","CITWP","COW","SERIALNO")]
census3 = fread('ss16pusc.csv')
census3 = census3[,c("ST","ADJINC","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","PINCP","AGEP","CITWP","COW","SERIALNO")]
census4 = fread('ss16pusd.csv')
census4 = census4[,c("ST","ADJINC","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","PINCP","AGEP","CITWP","COW","SERIALNO")]
census = rbind(census1, census2, census3, census4)
census = census[!is.na(census$FOD1P),]
census$survey_year <-substr(census$SERIALNO,1,4)
census$survey_year <- as.numeric(census$survey_year)
census$college_year<-census$survey_year - census$AGEP + 18
census = census[,c("ST","ADJINC","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","PINCP","AGEP","CITWP","COW","survey_year", "college_year")]
state <- read.csv("us-state-ansi-fips.csv")
state <- read.csv("us-state-ansi-fips.csv")
colnames(state)[2] <- "ST"
census <- merge(x = census, y = state, by = "ST", all.x = TRUE)
census$income_2016 <- census$ADJINC*0.000001*census$PINCP
census = census[,c("ST","FOD1P","SCH","SCHG","SCHL","INDP","NAICSP","SEX","RAC1P","AGEP","COW","survey_year", "college_year", "stname", "stusps", "income_2016")]
library(data.table)
admin = fread('adm2016.csv')
code = fread('ipeds.csv')
sum(is.na(admin$APPLCN) == T)
sum(is.na(admin$ADMSSN) == T)
sum(is.na(admin$ENRLT) == T)
adm = admin[,c("UNITID","APPLCN","ADMSSN","ENRLT")]
adm_location = merge(adm, code, by.x = "UNITID", by.y = "V1")
adm_location = na.omit(adm_location)
adm_state = aggregate(adm_location[,c("APPLCN", "ADMSSN", "ENRLT")], by=list(adm_location$state), FUN=sum, na.rm=TRUE)
View(adm_location)
adm_state = aggregate(adm_location[,c("APPLCN", "ADMSSN", "ENRLT")], by=list(adm_location$V4), FUN=sum, na.rm=TRUE)
View(adm_state)
names(adm_state)[1]<-"STATE"
adm_state$ADMRATE = adm_state$ADMSSN / adm_state$APPLCN
adm_state$ENRRATE = adm_state$ENRLT / adm_state$ADMSSN
dim(census)
summary(census)
library(ggplot2)
ggplot(census, aes(x=stusps)) + geom_bar(aes(y = ..count..))+ labs(x='state', y = 'count')
ggplot(census, aes(x=SEX)) + geom_bar(aes(y = ..count..))+ labs(x='gender', y = 'count')+ scale_x_discrete(limits=c(1, 2), labels=c("male", "female"))
ggplot(census, aes(x=RAC1P)) + geom_bar(aes(y = (..count..)/sum(..count..)))+ labs(x='race', y = 'count')+ scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9), labels=c("White", "Black","American Indian", "Alaska Native", "American Indian and Alaska Native", "Asian", "Pacific Islander", "Some Other Race", "Two or More Races"))
library(dplyr)
census %>%
group_by(RAC1P) %>%
summarise (n = n()) %>%
mutate(freq = n / sum(n))
hist(census$income_2016, breaks = 80)
hist(census$AGEP)
hist(census$college_year)
hist(census$income_2016, breaks = 80, xlab="adjusted income"", main=”Distribution of Income”)
```
hist(census$income_2016, breaks = 80, xlab="adjusted income", main="Distribution of Income")
hist(census$income_2016, breaks = 80, xlab="adjusted income", main="Distribution of Income")
hist(census$AGEP, xlab="age", main="Distribution of Age"))
hist(census$AGEP, xlab="age", main="Distribution of Age")
hist(census$college_year, xlab="college year", main="Distribution of College Year")
ggplot(census, aes(x=stusps, y=income_2016)) + stat_summary(fun.y="mean", geom="bar") + labs(x='state', y = 'average income')
ggplot(census, aes(x=AGEP, y=income_2016)) + stat_summary(fun.y="mean", geom="bar") + labs(x='age', y = 'average income')
ggplot(census, aes(x=SEX, y=income_2016)) + stat_summary(fun.y="mean", geom="bar") + scale_x_discrete(limits=c(1, 2), labels=c("male", "female")) + labs(x='gender', y = 'average income')
ggplot(census, aes(x=RAC1P, y=income_2016)) + stat_summary(fun.y="mean", geom="bar") + scale_x_discrete(limits=c(1, 2,3,4,5,6,7,8,9), labels=c("White", "Black","American Indian", "Alaska Native", "American Indian and Alaska Native", "Asian", "Pacific Islander", "Some Other Race", "Two or More Races")) + labs(x='Race', y = 'average income')
summary(adm_state)
which.max( adm_state[,2] )
colMax(adm_state)
print(colMax)
apply(adm_state, 2, function(x) max(x, na.rm = TRUE))
summary(adm_state)
row.names(adm_state) = adm_state$STATE
which.max( adm_state[,2] )
colMax(adm_state)
apply(adm_state, 2, function(x) max(x, na.rm = TRUE))
list(max(adm_state[,"APPLCN"]), adm_state[which.max(adm_state[,"APPLCN"]), "STATE"])
list(min(adm_state[,"APPLCN"]), adm_state[which.min(adm_state[,"APPLCN"]), "STATE"])
list(max(adm_state[,"ADMSSN"]), adm_state[which.max(adm_state[,"ADMSSN"]), "STATE"])
list(min(adm_state[,"ADMSSN"]), adm_state[which.min(adm_state[,"ADMSSN"]), "STATE"])
list(max(adm_state[,"APPLCN"]), adm_state[which.max(adm_state[,"APPLCN"]), "STATE"])
list(min(adm_state[,"APPLCN"]), adm_state[which.min(adm_state[,"APPLCN"]), "STATE"])
list(max(adm_state[,"ADMSSN"]), adm_state[which.max(adm_state[,"ADMSSN"]), "STATE"])
list(min(adm_state[,"ADMSSN"]), adm_state[which.min(adm_state[,"ADMSSN"]), "STATE"])
list(max(adm_state[,"ENRLT"]), adm_state[which.max(adm_state[,"ENRLT"]), "STATE"])
list(min(adm_state[,"ENRLT"]), adm_state[which.min(adm_state[,"ENRLT"]), "STATE"])
list(max(adm_state[,"ADMRATE"]), adm_state[which.max(adm_state[,"ADMRATE"]), "STATE"])
list(min(adm_state[,"ADMRATE"]), adm_state[which.min(adm_state[,"ADMRATE"]), "STATE"])
list(max(adm_state[,"ENRRATE"]), adm_state[which.max(adm_state[,"ENRRATE"]), "STATE"])
list(min(adm_state[,"ENRRATE"]), adm_state[which.min(adm_state[,"ENRRATE"]), "STATE"])
histogram(adm_state$APPLCN)
hist(adm_state$APPLCN)
hist(adm_state$ADMSSN)
hist(adm_state$ENRLT)
hist(adm_state$ENRRATE)
ggplot(adm_state, aes(x=STATE)) + geom_bar(aes(y = ..count..))+ labs(x='state', y = 'count')
hist(adm_state$APPLCN)
hist(adm_state$APPLCN, xlab="Application", main="Distribution of College Application")
list(max(adm_state[,"APPLCN"]), adm_state[which.max(adm_state[,"APPLCN"]), "STATE"])
list(min(adm_state[,"APPLCN"]), adm_state[which.min(adm_state[,"APPLCN"]), "STATE"])
list(max(adm_state[,"ADMSSN"]), adm_state[which.max(adm_state[,"ADMSSN"]), "STATE"])
list(min(adm_state[,"ADMSSN"]), adm_state[which.min(adm_state[,"ADMSSN"]), "STATE"])
list(max(adm_state[,"ENRLT"]), adm_state[which.max(adm_state[,"ENRLT"]), "STATE"])
list(max(adm_state[,"ENRLT"]), adm_state[which.max(adm_state[,"ENRLT"]), "STATE"])
list(max(adm_state[,"APPLCN"]), adm_state[which.max(adm_state[,"APPLCN"]), "STATE"])
list(min(adm_state[,"APPLCN"]), adm_state[which.min(adm_state[,"APPLCN"]), "STATE"])
list(max(adm_state[,"ADMSSN"]), adm_state[which.max(adm_state[,"ADMSSN"]), "STATE"])
list(min(adm_state[,"ADMSSN"]), adm_state[which.min(adm_state[,"ADMSSN"]), "STATE"])
list(max(adm_state[,"ENRLT"]), adm_state[which.max(adm_state[,"ENRLT"]), "STATE"])
list(min(adm_state[,"ENRLT"]), adm_state[which.min(adm_state[,"ENRLT"]), "STATE"])
list(max(adm_state[,"ADMRATE"]), adm_state[which.max(adm_state[,"ADMRATE"]), "STATE"])
list(min(adm_state[,"ADMRATE"]), adm_state[which.min(adm_state[,"ADMRATE"]), "STATE"])
list(max(adm_state[,"ENRRATE"]), adm_state[which.max(adm_state[,"ENRRATE"]), "STATE"])
list(min(adm_state[,"ENRRATE"]), adm_state[which.min(adm_state[,"ENRRATE"]), "STATE"])
name = names(adm_location)
UNITID = 'Unique identification number of the institution used by the NCES'
APPLCN = 'Total number of applicants for each university'
ADMSSN = 'Total number of admissions provided by each university'
ENRLT = 'Total number of enrollments for each university'
des = c(UNITID,APPLCN,ADMSSN,ENRLT)
library(DT)
des_table = datatable(cbind(name,des))
des_table
install.packages("gdata")
library(gdata)
df = read.xls ("World_firearms_murders_and_ownership.xlsx"), sheet = 1, header = TRUE)
df = read.xls ("World_firearms_murders_and_ownership.xlsx", sheet = 1, header = TRUE)
library(xlsx)
r.version()
r.version()
R.version()
R.Version()
library(readxl)
install.packages("tidyverse")
word_firearm <- read.csv("World_firearms_murders_and_ownership.csv")
word_firearm <- read.csv("World_firearms_murders_and_ownership.csv")
world_firearm <- read.csv("World_firearms_murders_and_ownership.csv")
p <- ggplot(world_firearm, aes(Country.Territory, Number.of.homicides.by.firearm))
library(ggplot2)
p <- ggplot(world_firearm, aes(Country.Territory, Number.of.homicides.by.firearm))
p + geom_bar(stat = "identity")
p + geom_bar()
p <- ggplot(world_firearm, aes(Country.Territory, Number.of.homicides.by.firearm))
p + geom_bar()
p + geom_bar(stat = "identity")
p <- ggplot(world_firearm, aes(Country.Territory, Number.of.homicides.by.firearm))
selected_firearm <- subset(world_firearm, Number.of.homicides.by.firearm >1)
View(selected_firearm)
View(selected_firearm)
View(world_firearm)
selected_firearm <- subset(world_firearm, Homicide.by.firearm.rate.per.100.000.pop >1)
p <- ggplot(selected_firearm, aes(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop))
p + geom_bar(stat = "identity")
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, -Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
area.color <- c(NA, "withcolor", NA, NA)
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop, fill=area.color))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=area.color))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop, area.color))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
area.color <- c(NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA, "withcolor", NA, NA,NA,NA)
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop, area.color))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual（value=c("grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red"))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(value=c("grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red"))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c("grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red"))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop), area)
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c("grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red"))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop), Country.Territory)
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c("grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red","grey50","red"))
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop))
p + geom_bar(stat = "identity", fill="#FF9999") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
aaa
hehe <- c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999")
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop, reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(hehe)
p <- ggplot(selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), Homicide.by.firearm.rate.per.100.000.pop, reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(value=c("#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"))
p + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c("#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"))
p <- ggplot(x=selected_firearm, aes(reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
p <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
p + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999")) +theme(axis.text.x = element_text(angle = 90, hjust = 1))
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999")) +theme(axis.text.x = element_text(angle = 90, hjust = 1))
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999")) +theme(axis.text.x = element_text(angle = 90, hjust = 1))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
abortion <- read.csv("abortion.csv")
View(abortion)
firearm_81 <- read.csv("firearm1981_1998.csv")
firearm_81 <- read.csv("firearm1981_1998.csv")
firearm_99 <- read.csv("firearm1999_2016.csv")
firearm <- rbind(firearm_81, firearm_99)
View(firearm)
abortion[adjusted_year] <- abortion[year] +20
abortion[adjusted_year] <- abortion[Year] +20
abortion <- read.csv("abortion.csv")
abortion[adjusted_year] <- abortion[Year] +20
abortion["adjusted_year"] <- abortion["Year"] +20
View(abortion)
abortion <- read.csv("abortion.csv")
abortion["Year"] <- abortion["Year"] +20
View(abortion)
merge(firearm, firearm, by = "Year")
firearm_abortion <-merge(firearm, firearm, by = "Year")
View(firearm_abortion)
write.csv(firearm_abortion, file = "firearm_abortion.csv")
View(abortion)
View(firearm)
firearm <- firearm[, c("Year", "Crude.Rate")]
firearm_abortion <- merge(firearm, firearm, by = "Year")
View(firearm_abortion)
firearm_abortion <- merge(firearm, abortion, by = "Year")
View(firearm_abortion)
write.csv(firearm_abortion, file = "firearm_abortion.csv")
write.csv(firearm_abortion, file = "firearm_abortion.csv")
australia <- read.csv("Australia-Homicides-Suicides.csv")
australia <- read.csv("Australia-Homicides-Suicides.csv")
colnames(australia)[1] <- "Year"
View(australia)
colnames(australia)[2] <- "firearm_suicide"
colnames(australia)[5] <- "non_firearm_suicide"
australia <- australia[, c("Year", "firearm_suicide", "non_firearm_suicide")]
write.csv(australia, file = "australia.csv")
australia <- subset(australia, Year > 1967)
write.csv(australia, file = "australia.csv")
getwd()
shoot_2014 <- read.csv("shoot_2014.csv", header = TRUE)
shoot_2015 <- read.csv("shoot_2015.csv", header = TRUE)
shoot_2016 <- read.csv("shoot_2016.csv", header = TRUE)
shoot_2017 <- read.csv("shoot_2017.csv", header = TRUE)
shoot_2018 <- read.csv("shoot_2018.csv", header = TRUE)
mass_shoot <- rbind(shoot_2014, shoot_2015, shoot_2016, shoot_2017, shoot_2018)
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population$GEO.display.label <- as.character(population$GEO.display.label)
library(tidyr)
separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
View(population)
colnames(population)[3] <- "Population"
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
colnames(population)[3] <- "Population"
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
colnames(population)[3] <- "Population"
write.csv(mass_shoot, file = "mass_shoot.csv")
write.csv(population, file = "population_2017.csv")
View(mass_shoot)
View(population)
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
library(tidyr)
View(population)
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = " County, ")
View(population)
View(population)
population[is.na(population$State),]
View(mass_shoot)
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population$GEO.display.label <- as.character(population$GEO.display.label)
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
colnames(population)[3] <- "Population"
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
world_firearm <- read.csv("World_firearms_murders_and_ownership.csv")
selected_firearm <- subset(world_firearm, Homicide.by.firearm.rate.per.100.000.pop >1)
library(ggplot2)
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm <- ggplot(selected_firearm, aes(y=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), x=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.y = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(y = "Country", x = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1") +
```
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1") +
```
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm <- ggplot(selected_firearm, aes(y=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), x=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.y = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(y = "Country", x = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1") +
```
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black"))+ labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")
firearm + geom_bar(stat = "identity")
firearm <- ggplot(selected_firearm, aes(y=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), x=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity")
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")+ coord_flip()
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1")+ coord_flip()
firearm_81_98 <- read.csv('firearm1981_1998.csv', header = TRUE)
firearm_99_16 <- read.csv('firearm1999_2016.csv', header = TRUE)
homicide_81_98 <- read.csv('homicide1981_1998.csv', header = TRUE)
homicide_99_16 <- read.csv('homicide1999_2016.csv', header = TRUE)
unintentional_81_98 <- read.csv('unintentional1981_1998.csv', header = TRUE)
unintentional_99_16 <- read.csv('unintentional1999_2016.csv', header = TRUE)
firearm <- rbind(firearm_81_98, firearm_99_16)
firearm <- firearm[,c("Year", "Cause.of.Death", "Crude.Rate")]
homicide <- rbind(homicide_81_98, homicide_99_16)
homicide <- homicide[,c("Year", "Cause.of.Death", "Crude.Rate")]
unintentional <- rbind(unintentional_81_98, unintentional_99_16)
unintentional <- unintentional[,c("Year", "Cause.of.Death", "Crude.Rate")]
fatal_rate <- rbind(firearm, homicide, unintentional)
View(fatal_rate)
fatal_rate <- fatal_rate[!is.na(fatal_rate$Year),]
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Homicide/Legal Intervention Injury"] <- "Violence-Related"
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Unintentional Injury"] <- "Unintentional"
fatal_rate <- subset(fatal_rate, Year < 2011)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')
firearm_81_98 <- read.csv('firearm1981_1998.csv', header = TRUE)
firearm_99_16 <- read.csv('firearm1999_2016.csv', header = TRUE)
homicide_81_98 <- read.csv('homicide1981_1998.csv', header = TRUE)
homicide_99_16 <- read.csv('homicide1999_2016.csv', header = TRUE)
unintentional_81_98 <- read.csv('unintentional1981_1998.csv', header = TRUE)
firearm <- rbind(firearm_81_98, firearm_99_16)
firearm <- firearm[,c("Year", "Cause.of.Death", "Crude.Rate")]
homicide <- rbind(homicide_81_98, homicide_99_16)
homicide <- homicide[,c("Year", "Cause.of.Death", "Crude.Rate")]
unintentional <- rbind(unintentional_81_98, unintentional_99_16)
unintentional <- unintentional[,c("Year", "Cause.of.Death", "Crude.Rate")]
fatal_rate <- rbind(firearm, homicide, unintentional)
fatal_rate <- fatal_rate[!is.na(fatal_rate$Year),]
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Homicide/Legal Intervention Injury"] <- "Violence-Related"
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Unintentional Injury"] <- "Unintentional"
fatal_rate <- subset(fatal_rate, Year < 2011)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')
View(fatal_rate)
firearm <- rbind(firearm_81_98, firearm_99_16)
firearm <- firearm[,c("Year", "Cause.of.Death", "Crude.Rate")]
homicide <- rbind(homicide_81_98, homicide_99_16)
homicide <- homicide[,c("Year", "Cause.of.Death", "Crude.Rate")]
unintentional <- rbind(unintentional_81_98, unintentional_99_16)
unintentional <- unintentional[,c("Year", "Cause.of.Death", "Crude.Rate")]
fatal_rate <- rbind(firearm, homicide, unintentional)
fatal_rate <- fatal_rate[!is.na(fatal_rate$Year),]
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Violence-Related Injury"] <- "Violence-Related"
fatal_rate$Cause.of.Death[fatal_rate$Cause.of.Death == "Unintentional Injury"] <- "Unintentional"
fatal_rate <- subset(fatal_rate, Year < 2011)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population$GEO.display.label <- as.character(population$GEO.display.label)
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = " County, ")
colnames(population)[3] <- "Population"
write.csv(population, file = "population_2017.csv")
View(population)
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
population <- separate(population,County,into=c("County", "State" ),sep = ", ")
shoot_2014 <- read.csv("shoot_2014.csv", header = TRUE)
shoot_2015 <- read.csv("shoot_2015.csv", header = TRUE)
shoot_2016 <- read.csv("shoot_2016.csv", header = TRUE)
shoot_2017 <- read.csv("shoot_2017.csv", header = TRUE)
shoot_2018 <- read.csv("shoot_2018.csv", header = TRUE)
mass_shoot <- rbind(shoot_2014, shoot_2015, shoot_2016, shoot_2017, shoot_2018)
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population$GEO.display.label <- as.character(population$GEO.display.label)
population <- separate(population,County,into=c("County", "State" ),sep = ", ")
colnames(population)[3] <- "Population"
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population$GEO.display.label <- as.character(population$GEO.display.label)
library(tidyr)
population <- read.csv("PEP_2017_PEPANNRES_with_ann.csv")
population <- population[, c("GEO.display.label", "respop72017")]
population <- population[-c(1), ]
population <- separate(population,County,into=c("County", "State" ),sep = ", ")
population <- separate(population,GEO.display.label,into=c("County", "State" ),sep = ", ")
colnames(population)[3] <- "Population"
View(population)
mass_shoot <- merge(x = mass_shoot, y = population, by = "State", all.y = TRUE)
View(mass_shoot)
cars1 <- cars[1:30, ]  # original data
cars_outliers <- data.frame(speed=c(19,19,20,20,20), dist=c(190, 186, 210, 220, 218))  # introduce outliers.
cars2 <- rbind(cars1, cars_outliers)  # data with outliers.
par(mfrow=c(1, 2))
plot(cars2$speed, cars2$dist, xlim=c(0, 28), ylim=c(0, 230), main="With Outliers", xlab="speed", ylab="dist", pch="*", col="red", cex=2)
plot(cars2$dist,cars2$speed)
library(ggplot2)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')+ annotation_custom(grob = textGrob("Extra text.  Read all about it"), xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55)
ibrary(gridExtra)
library(gridExtra)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')+ annotation_custom(grob = textGrob("Extra text.  Read all about it"), xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55)
library(grid)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death')+ annotation_custom(grob = textGrob("Extra text.  Read all about it"), xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55)
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death',caption = "H. Wickham. ggplot2: Elegant Graphics for Data Analysis Springer-Verlag New York, 2009.")
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death',caption = "Source: ")
ggplot(data=fatal_rate, aes(x=Year, y=Crude.Rate, group = Cause.of.Death, colour = as.factor(Cause.of.Death))) + geom_line() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(title = 'Rate of Homicide and Unintentional Deaths, 1981-2010', y = 'Per 100,000 people', colour= 'Cause of death',caption = "Source: Centers for Disease Control and Prevention.Fatal Injury Reports, 1981 to 2016, National, Regional and State")
firearm <- ggplot(selected_firearm, aes(x=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop), y=Homicide.by.firearm.rate.per.100.000.pop, fill=reorder(Country.Territory, Homicide.by.firearm.rate.per.100.000.pop)))
firearm + geom_bar(stat = "identity") + scale_fill_manual(values=c("#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#CC6666","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999","#999999"), guide=FALSE) +theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.background = element_blank(), axis.line = element_line(colour = "black")) + labs(x = "Country", y = "Homicides by firearm per 1 million people", title = "Homicides by firearm per 1 million people", subtitle = "with countries' rate greater than 1", caption = "Source: UNODC & Small arms survey")+ coord_flip()
